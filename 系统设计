系统有哪些业务组成部分，如何实现业务流程。各个环节的技术问题，解决思路。

1.电商积分兑换
需求：用户购买商品、评价获取积分；积分达到一定值后，可根据积分兑换商品。
业务流程：积分表：自增id，userid，credit。兑换商品表：自增id，userid，skuid，credit。扣减积分、商品库存，并插入兑换记录。通知仓储业务发货，需要发货申请表：自增id，发货类型（购买，积分兑换），兑换表id，skuid，物流单号。
事务保证：MQ + 本地消息表 + 重试。幂等：发货申请表的兑换表id字段为unique key。

2.秒杀

3.百万用户的IM消息系统

4.微信红包

5.百万级用户的抽奖系统
需求：有1w奖品，用户某时间开始抽奖，假设有几十万瞬间请求，中奖后发请求给礼品服务发放奖品。
未优化：LB -》 抽奖服务 -> mysql: 奖品更新  -> 礼品服务
LB：10w请求。防止用户重复抽奖：屏蔽1min内同一用户的多次请求。拦截后续流量：前1w请求抽完奖后，其他请求直接返回。抽奖服务开奖完毕，更新zk/redis状态，LB得到状态后拦截返回抽奖结束。
web server：2w请求。tomcat每个请求都给独立线程处理，常200-500，需要压测调参。集群。 mysql -》redis：记录奖品余额。
发放礼品限流削峰：MQ。

6.扫码登录
网页端+网页服务器：1.用户打开登录网页，向服务器发获取登录二维码的请求。2.服务器受到请求，生成随机uuid，放入redis，并设置expire time，过期后用户需要刷新重新获取二维码。根据uuid+公司验证字符串，通过genCharCode()接口，生成二维码图片，将图片+uuid返回browser。3.browser收到图片+uuid，每隔1s向server发请求，查看该uuid是否登录成功。
手机端+手机服务器：4.扫二维码，得到uuid+公司验证信息。由于手机端已登录，根据token(加密userid)+uuid+验证信息，请求手机server。5.手机server对比验证信息，userid是否已登录，返回ack给手机端。6.手机收到ack，显示确认登录框，防止误操作。确认后，再次发请求。7.server根据uuid+userid，写入redis。
登录成功：8.browser定期发请求时，网页server可从redis获取userid。调用login()，生成browser token，将用户信息返回browser。
