系统有哪些业务组成部分，如何实现业务流程。各个环节的技术问题，解决思路。

1.电商积分兑换
需求：用户购买商品、评价获取积分；积分达到一定值后，可根据积分兑换商品。
业务流程：积分表：自增id，userid，credit。兑换商品表：自增id，userid，skuid，credit。扣减积分、商品库存，并插入兑换记录。通知仓储业务发货，需要发货申请表：自增id，发货类型（购买，积分兑换），兑换表id，skuid，物流单号。
事务保证：MQ + 本地消息表 + 重试。幂等：发货申请表的兑换表id字段为unique key。

2.秒杀

3.百万用户的IM消息系统

4.微信红包

5.百万级用户的抽奖系统
需求：有1w奖品，用户某时间开始抽奖，假设有几十万瞬间请求，中奖后发请求给礼品服务发放奖品。
未优化：LB -》 抽奖服务 -> mysql: 奖品更新  -> 礼品服务
LB：10w请求。防止用户重复抽奖：屏蔽1min内同一用户的多次请求。拦截后续流量：前1w请求抽完奖后，其他请求直接返回。抽奖服务开奖完毕，更新zk/redis状态，LB得到状态后拦截返回抽奖结束。
web server：2w请求。tomcat每个请求都给独立线程处理，常200-500，需要压测调参。集群。 mysql -》redis：记录奖品余额。
发放礼品限流削峰：MQ。
